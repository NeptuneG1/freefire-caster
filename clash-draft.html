<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Free Fire Clash Squad Draft (Enhanced)</title>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600&family=Roboto&display=swap" rel="stylesheet">
<style>
body {margin:0; font-family:'Roboto', sans-serif; background:#0e0e0e; color:#f5f5f5}
header {background:#1f1f1f; padding:20px; text-align:center; border-bottom:3px solid #ffbd59}
header h1 {font-family:'Orbitron', sans-serif; color:#ffbd59; margin:0; font-size:2rem}
.teams {display:flex; justify-content:space-around; margin:20px}
.team {width:45%; border:2px solid #ffbd59; border-radius:10px; padding:10px}
.player {border-top:1px solid #555; padding:10px; display:flex; flex-direction:column; align-items:center}
.weapon-slots img {width:40px; height:40px; margin:2px; border:2px solid #ffbd59; border-radius:6px}
.player button {margin-top:5px; padding:5px 10px; background:#ffbd59; border:none; border-radius:5px; cursor:pointer; font-weight:bold}
.player button:hover {background:#e0a84f}
table {width:100%; border-collapse:collapse; margin-top:20px}
table, th, td {border:1px solid #999}
th, td {padding:4px; text-align:center}
</style>
</head>
<body>
<header><h1>Free Fire Clash Squad Draft (Enhanced)</h1></header>
<div class="teams">
<div class="team" id="teamLeft">
<h2>Team Left</h2>
<div id="leftPlayers"></div>
</div>
<div class="team" id="teamRight">
<h2>Team Right</h2>
<div id="rightPlayers"></div>
</div>
</div>
<h2 style="text-align:center">Player Skill Overview</h2>
<div class="teams">
<div class="team"><h3>Team Left</h3><table id="tableLeft"></table></div>
<div class="team"><h3>Team Right</h3><table id="tableRight"></table></div>
</div>
<script>
const client = supabase.createClient('https://gkugecflfddkpitlrmws.supabase.co','eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImdrdWdlY2ZsZmRka3BpdGxybXdzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDYwODMwNzQsImV4cCI6MjA2MTY1OTA3NH0');
client.auth.getSession().then(({ data: { session } }) => { if(!session) window.location.href="index.html"; });

let players = {left:[], right:[]};
for (let t of ['left', 'right']) for (let i = 1; i <= 4; i++) players[t].push({ weapons: [null, null], active: null, passives: [] });

function loadPlayers() {
  ['left','right'].forEach(t => {
    let div = document.getElementById(t === 'left' ? 'leftPlayers' : 'rightPlayers');
    div.innerHTML = '';
    players[t].forEach((p, i) => {
      div.innerHTML += `<div class='player'><div class='weapon-slots'>
      <img src='https://via.placeholder.com/40' onclick='setWeapon("${t}",${i},0)'>
      <img src='https://via.placeholder.com/40' onclick='setWeapon("${t}",${i},1)'></div>
      <b>Player ${i+1}</b>
      <button onclick='setActive("${t}",${i})'>Set Active Skill</button>
      <button onclick='setPassive("${t}",${i})'>Add Passive Skill</button>
      </div>`;
    });
  });
  updateTables();
}

function setWeapon(team, player, slot) {
  let weapon = prompt("Enter weapon name (or leave blank to clear)");
  players[team][player].weapons[slot] = weapon || null;
  loadPlayers();
}

function setActive(team, player) {
  let skill = prompt("Enter Active Skill Name");
  players[team][player].active = skill;
  loadPlayers();
}

function setPassive(team, player) {
  if (players[team][player].passives.length >= 3) return alert("Max 3 passives");
  let skill = prompt("Enter Passive Skill Name");
  players[team][player].passives.push(skill);
  loadPlayers();
}

function updateTables() {
  ['left','right'].forEach(t => {
    let tbl = document.getElementById(t==='left'?'tableLeft':'tableRight');
    tbl.innerHTML = '<tr><th>Player</th><th>Weapons</th><th>Active</th><th>Passives</th></tr>';
    players[t].forEach((p,i)=>{
      tbl.innerHTML += `<tr><td>Player ${i+1}</td><td>${p.weapons.filter(Boolean).join(', ')||'-'}</td><td>${p.active||'-'}</td><td>${p.passives.join(', ')||'-'}</td></tr>`;
    });
  });
}

loadPlayers();
</script>
</body>
</html>

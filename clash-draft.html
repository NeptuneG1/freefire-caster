<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Clash Squad Draft V2.2</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: #1c1f26;
      color: #f0f0f0;
      margin: 0;
      padding: 20px;
    }
    h1 {
      text-align: center;
      color: #ff7733;
    }
    .draft-wrapper {
      display: flex;
      justify-content: center;
      align-items: flex-start;
      gap: 50px;
      margin-top: 20px;
      flex-wrap: nowrap;
    }
    .team-container {
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .team-label {
      color: #ff7733;
      font-weight: bold;
      font-size: 18px;
      margin-bottom: 10px;
    }
    .team-row {
      display: flex;
      gap: 10px;
    }
    .slot {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 4px;
    }
    .ban-slot, .pick-slot {
      width: 100px;
      height: 150px;
      background: #2a2a2a;
      border: 2px solid #444;
      border-radius: 8px;
      display: flex;
      justify-content: center;
      align-items: center;
      cursor: pointer;
      position: relative;
    }
    .ban-slot {
      border-color: #ff5a5a;
    }
    .ban-slot.disabled, .pick-slot.disabled {
      opacity: 0.4;
      pointer-events: none;
    }
    .passive-slots, .weapon-slots {
      display: flex;
      gap: 3px;
      justify-content: center;
      flex-wrap: wrap;
    }
    .passive-slot {
      width: 30px;
      height: 50px;
      background: #3a3a3a;
      border: 1px solid #555;
      border-radius: 4px;
      cursor: pointer;
      background-size: cover;
      background-position: center;
    }
    .weapon-slot {
      width: 100px;
      height: 40px;
      background: #2a2a2a;
      border: 2px solid #444;
      border-radius: 6px;
      cursor: pointer;
      display: flex;
      justify-content: center;
      align-items: center;
      position: relative;
    }
    .weapon-slot img {
      max-height: 100%;
      max-width: 100%;
    }
    .slot-name {
      font-size: 12px;
      color: #ccc;
      text-align: center;
    }
    .passive-name, .weapon-name {
      font-size: 10px;
      color: #ccc;
      text-align: center;
      max-width: 40px;
      overflow: hidden;
      white-space: nowrap;
      text-overflow: ellipsis;
    }
    .modal {
      display: none;
      position: fixed;
      z-index: 9999;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.85);
      overflow: auto;
    }
    .modal-content {
      background: #1f1f1f;
      margin: 5% auto;
      padding: 15px;
      border: 2px solid #ff7733;
      border-radius: 8px;
      width: 90%;
      max-width: 800px;
      max-height: 90vh;
      overflow-y: auto;
      position: relative;
    }
    .close-btn {
      position: absolute;
      top: 10px;
      right: 15px;
      color: #ff7733;
      font-size: 18px;
      font-weight: bold;
      cursor: pointer;
    }
    .hero-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(70px, 1fr));
      gap: 8px;
      margin-top: 16px;
    }
    .hero-grid-item img {
      width: 100%;
      border-radius: 6px;
      cursor: pointer;
    }
    .disabled {
      opacity: 0.3;
      pointer-events: none;
    }
    .banned-overlay {
      position: absolute;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(255,0,0,0.4);
      color: white;
      font-weight: bold;
      display: flex;
      justify-content: center;
      align-items: center;
      border-radius: 6px;
      font-size: 12px;
    }
    .reset-btn {
      margin: 20px auto;
      display: block;
      background: #ff7733;
      color: #fff;
      border: none;
      padding: 10px 18px;
      border-radius: 5px;
      cursor: pointer;
      font-size: 16px;
    }
    .summary-wrapper {
      display: flex;
      justify-content: center;
      gap: 50px;
      margin-top: 30px;
      font-size: 12px;
      color: #ddd;
    }
    .summary-team {
      max-width: 400px;
    }
    .summary-team h3 {
      text-align: center;
      color: #ff7733;
      margin-bottom: 10px;
    }
  </style>
</head>
<body>
<h1>Free Fire Clash Squad Draft V2.2</h1>
<div class="draft-wrapper">
  <div class="team-container">
    <div class="team-label">TEAM LEFT</div>
    <div class="team-row" id="teamLeft"></div>
  </div>
  <div class="team-container">
    <div class="team-label">TEAM RIGHT</div>
    <div class="team-row" id="teamRight"></div>
  </div>
</div>
<button class="reset-btn" onclick="resetDraft()">Reset All</button>

<!-- NEW summary display -->
<div class="summary-wrapper">
  <div class="summary-team" id="summaryLeft"></div>
  <div class="summary-team" id="summaryRight"></div>
</div>

<!-- Modal -->
<div class="modal" id="heroModal">
  <div class="modal-content">
    <span class="close-btn" onclick="closeModal()">X</span>
    <h3 style="color:#ff7733;" id="modalTitle">Select</h3>
    <div class="hero-grid" id="heroGrid"></div>
  </div>
</div>

<script>
let characters = [];
let weapons = [];
let draftState = {
  bans: [null, null],
  picks: Array.from({length:8}, () => null),
  passives: Array.from({length:8}, () => [null, null, null]),
  weapons: Array.from({length:8}, () => [null, null])
};
let currentSlot = null;
document.addEventListener('DOMContentLoaded', () => loadData());

async function loadData() {
  const res1 = await fetch('https://neptuneg1.github.io/freefire-caster/character.json');
  characters = await res1.json();
  const res2 = await fetch('https://neptuneg1.github.io/freefire-caster/weapon.json');
  weapons = await res2.json();
  drawDraft();
}
  function drawDraft() {
  const teamLeft = document.getElementById('teamLeft');
  const teamRight = document.getElementById('teamRight');
  teamLeft.innerHTML = '';
  teamRight.innerHTML = '';
  teamLeft.appendChild(makeSlot('ban', 0));
  for (let i = 0; i < 4; i++) teamLeft.appendChild(makeSlot('pick', i));
  for (let i = 4; i < 8; i++) teamRight.appendChild(makeSlot('pick', i));
  teamRight.appendChild(makeSlot('ban', 1));
  updateSummary();
}

function makeSlot(type, index) {
  const container = document.createElement('div');
  container.className = 'slot';
  const main = document.createElement('div');
  main.className = type === 'ban' ? 'ban-slot' : 'pick-slot';
  const img = document.createElement('img');
  img.src = 'https://imgur.com/AdvPwAO.png';
  img.style.width = '100%';
  img.style.height = '100%';
  img.style.borderRadius = '8px';
  main.appendChild(img);

  const nameDiv = document.createElement('div');
  nameDiv.className = 'slot-name';

  if (type === 'ban') {
    const hero = draftState.bans[index];
    if (hero) { img.src = hero.image_url; nameDiv.innerText = hero.name; main.classList.add('disabled'); }
    main.onclick = () => { currentSlot = { type, index }; openModal('Select Hero to Ban'); };
  } else {
    const hero = draftState.picks[index];
    if (hero) { img.src = hero.image_url; nameDiv.innerText = hero.name; }
    main.onclick = () => { currentSlot = { type, index }; openModal('Select Active Skill'); };
  }

  container.appendChild(main);
  container.appendChild(nameDiv);

  if (type === 'pick') {
    const passives = draftState.passives[index];
    const passiveDiv = document.createElement('div');
    passiveDiv.className = 'passive-slots';
    passives.forEach((ps, i) => {
      const pSlot = document.createElement('div');
      pSlot.className = 'passive-slot';
      const passiveName = document.createElement('div');
      passiveName.className = 'passive-name';
      if (ps) { pSlot.style.backgroundImage = `url(${ps.image_url})`; passiveName.innerText = ps.name; }
      pSlot.onclick = () => { currentSlot = { type: 'passive', pickIndex: index, passiveIndex: i }; openModal('Select Passive Skill'); };
      const box = document.createElement('div');
      box.style.display = 'flex'; box.style.flexDirection = 'column'; box.style.alignItems = 'center';
      box.appendChild(pSlot); box.appendChild(passiveName); passiveDiv.appendChild(box);
    });
    container.appendChild(passiveDiv);

    const weaponDiv = document.createElement('div');
    weaponDiv.className = 'weapon-slots';
    draftState.weapons[index].forEach((w, i) => {
      const wSlot = document.createElement('div');
      wSlot.className = 'weapon-slot';
      const wName = document.createElement('div');
      wName.className = 'weapon-name';
      if (w) { 
        const wImg = document.createElement('img'); 
        wImg.src = w.image_url; wSlot.appendChild(wImg); 
        wName.innerText = w.name; 
      }
      wSlot.onclick = () => { currentSlot = { type: 'weapon', pickIndex: index, weaponIndex: i }; openModal('Select Weapon'); };
      const wBox = document.createElement('div');
      wBox.style.display = 'flex'; wBox.style.flexDirection = 'column'; wBox.style.alignItems = 'center';
      wBox.appendChild(wSlot); wBox.appendChild(wName); weaponDiv.appendChild(wBox);
    });
    container.appendChild(weaponDiv);
  }
  return container;
}

function openModal(title) {
  document.getElementById('modalTitle').innerText = title;
  const grid = document.getElementById('heroGrid');
  grid.innerHTML = '';
  const usedNames = new Set();
  draftState.bans.forEach(h => h && usedNames.add(h.name));
  draftState.picks.forEach(h => h && usedNames.add(h.name));
  let list = [];
  if (currentSlot.type === 'weapon') list = weapons;
  else list = characters.filter(h => (currentSlot.type === 'passive') ? h.skill_type === 'Passive' : h.skill_type === 'Active');
  list.forEach(item => {
    const box = document.createElement('div');
    box.className = 'hero-grid-item';
    const img = document.createElement('img');
    img.src = item.image_url;
    img.title = item.name;
    if ((currentSlot.type === 'ban' || currentSlot.type === 'pick') && usedNames.has(item.name)) img.classList.add('disabled');
    else img.onclick = () => {
      if (currentSlot.type === 'ban') draftState.bans[currentSlot.index] = item;
      if (currentSlot.type === 'pick') draftState.picks[currentSlot.index] = item;
      if (currentSlot.type === 'passive') draftState.passives[currentSlot.pickIndex][currentSlot.passiveIndex] = item;
      if (currentSlot.type === 'weapon') draftState.weapons[currentSlot.pickIndex][currentSlot.weaponIndex] = item;
      closeModal(); drawDraft();
    };
    box.appendChild(img); grid.appendChild(box);
  });
  document.getElementById('heroModal').style.display = 'block';
}

function closeModal() { document.getElementById('heroModal').style.display = 'none'; }

function updateSummary() {
  const left = document.getElementById('summaryLeft');
  const right = document.getElementById('summaryRight');
  left.innerHTML = "<h3>TEAM LEFT</h3>";
  right.innerHTML = "<h3>TEAM RIGHT</h3>";

  if (draftState.bans[0]) {
    left.innerHTML += `<strong>Ban:</strong> ${draftState.bans[0].name}<br>${draftState.bans[0].description || ''}<br><br>`;
  } else left.innerHTML += `<strong>Ban:</strong> None<br><br>`;
  if (draftState.bans[1]) {
    right.innerHTML += `<strong>Ban:</strong> ${draftState.bans[1].name}<br>${draftState.bans[1].description || ''}<br><br>`;
  } else right.innerHTML += `<strong>Ban:</strong> None<br><br>`;

  left.innerHTML += '<div style="display:flex;gap:10px">';
  for (let i = 0; i < 4; i++) {
    const idx = i;
    const hero = draftState.picks[idx];
    let html = `<div style="display:flex;flex-direction:column;align-items:flex-start;width:180px; border:1px solid #555; border-radius:6px; padding:8px;">`;
    html += `<strong>Player ${i + 1}</strong><br>`;
    if (hero) html += `Character: ${hero.name}<br>${hero.description || ''}<br>`;
    else html += `Character: None<br>`;
    html += `Weapons:<br>`;
    draftState.weapons[idx].forEach(w => {
      if (w) {
        html += `- ${w.name}<br>Damage: ${w.damage}, RoF: ${w.rate_of_fire}, Range: ${w.range}, Mag: ${w.magazine_size}, Attr: ${w.special_attributes || 'None'}, Desc: ${w.description || ''}<br>`;
      }
    });
    html += `Passives: `;
    draftState.passives[idx].forEach(ps => ps && (html += `${ps.name} `));
    html += `<br></div>`;
    left.innerHTML += html;
  }
  left.innerHTML += '</div>';

  right.innerHTML += '<div style="display:flex;gap:10px">';
  for (let i = 3; i >= 0; i--) {
    const idx = 4 + i;
    const hero = draftState.picks[idx];
    let html = `<div style="display:flex;flex-direction:column;align-items:flex-start;width:180px; border:1px solid #555; border-radius:6px; padding:8px;">`;
    html += `<strong>Player ${4 - i}</strong><br>`;
    if (hero) html += `Character: ${hero.name}<br>${hero.description || ''}<br>`;
    else html += `Character: None<br>`;
    html += `Weapons:<br>`;
    draftState.weapons[idx].forEach(w => {
      if (w) {
        html += `- ${w.name}<br>Damage: ${w.damage}, RoF: ${w.rate_of_fire}, Range: ${w.range}, Mag: ${w.magazine_size}, Attr: ${w.special_attributes || 'None'}, Desc: ${w.description || ''}<br>`;
      }
    });
    html += `Passives: `;
    draftState.passives[idx].forEach(ps => ps && (html += `${ps.name} `));
    html += `<br></div>`;
    right.innerHTML += html;
  }
  right.innerHTML += '</div>';
}
  
function resetDraft() {
  draftState = {
    bans: [null, null],
    picks: Array.from({length:8}, () => null),
    passives: Array.from({length:8}, () => [null, null, null]),
    weapons: Array.from({length:8}, () => [null, null])
  };
  drawDraft();
}
</script>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>FFWS Style Draft</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: #1c1f26;
      color: #f0f0f0;
      margin: 0;
      padding: 20px;
    }
    .draft-row {
      display: flex;
      justify-content: center;
      align-items: flex-start;
      gap: 10px;
      margin-bottom: 20px;
    }
    .slot {
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .ban-slot, .pick-slot {
      width: 100px;
      height: 100px;
      background: #2a2a2a;
      border: 2px solid #444;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      position: relative;
    }
    .ban-slot {
      border-color: #ff5a5a;
    }
    .ban-slot.disabled, .pick-slot.disabled {
      opacity: 0.5;
      pointer-events: none;
    }
    .passive-slots {
      display: flex;
      gap: 5px;
      margin-top: 5px;
    }
    .passive-slot {
      width: 30px;
      height: 30px;
      background: #3a3a3a;
      border: 1px solid #555;
      border-radius: 4px;
      cursor: pointer;
    }
    .modal {
      display: none;
      position: fixed;
      z-index: 9999;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      overflow: auto;
    }
    .modal-content {
      background: #1f1f1f;
      margin: 5% auto;
      padding: 16px;
      border: 2px solid #ff7733;
      border-radius: 10px;
      width: 90%;
      max-width: 800px;
      max-height: 90vh;
      overflow-y: auto;
      position: relative;
    }
    .close-btn {
      position: absolute;
      top: 10px;
      right: 15px;
      color: #ff7733;
      font-size: 18px;
      font-weight: bold;
      cursor: pointer;
    }
    .hero-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(70px, 1fr));
      gap: 8px;
      margin-top: 16px;
    }
    .hero-grid-item {
      text-align: center;
      font-size: 11px;
      position: relative;
    }
    .hero-grid-item img {
      width: 100%;
      border-radius: 6px;
      cursor: pointer;
    }
    .disabled {
      pointer-events: none;
      opacity: 0.3;
    }
    .banned-overlay {
      position: absolute;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(255, 0, 0, 0.4);
      color: white;
      font-weight: bold;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 6px;
      font-size: 11px;
    }
    .reset-button {
      background: #ff7733;
      color: #fff;
      border: none;
      padding: 10px 20px;
      border-radius: 5px;
      cursor: pointer;
      font-size: 16px;
    }
  </style>
</head>
<body>
  <h1 style="text-align:center;">FFWS Style Draft</h1>
  <div class="draft-row" id="draftRow">
    <!-- Slots will be generated by JavaScript -->
  </div>
  <div style="text-align:center;">
    <button class="reset-button" onclick="resetDraft()">Reset</button>
  </div>

  <!-- Modal -->
  <div class="modal" id="heroModal">
    <div class="modal-content">
      <span class="close-btn" onclick="closeModal()">&times;</span>
      <h3 style="color:#ff7733" id="modalTitle">Select Hero</h3>
      <div class="hero-grid" id="heroGrid"></div>
    </div>
  </div>

  <script>
    const draftRow = document.getElementById('draftRow');
    const heroModal = document.getElementById('heroModal');
    const heroGrid = document.getElementById('heroGrid');
    const modalTitle = document.getElementById('modalTitle');

    let characterData = [];
    let currentSlot = null;
    let draftState = {
      bans: [null, null],
      picks: Array(8).fill(null),
      passives: Array(8).fill([null, null, null])
    };

    // Load character data
    async function loadCharacters() {
      const res = await fetch('character.json');
      characterData = await res.json();
      renderDraft();
    }

    function renderDraft() {
      draftRow.innerHTML = '';
      // Left Ban
      draftRow.appendChild(createSlot('ban', 0));
      // Picks
      for (let i = 0; i < 8; i++) {
        draftRow.appendChild(createSlot('pick', i));
      }
      // Right Ban
      draftRow.appendChild(createSlot('ban', 1));
    }

    function createSlot(type, index) {
      const slot = document.createElement('div');
      slot.className = 'slot';
      const mainSlot = document.createElement('div');
      mainSlot.className = type === 'ban' ? 'ban-slot' : 'pick-slot';
      const img = document.createElement('img');
      img.src = 'https://i.imgur.com/kkUX3a3.jpeg';
      img.style.width = '100%';
      img.style.height = '100%';
      img.style.borderRadius = '8px';
      mainSlot.appendChild(img);

      if (type === 'ban') {
        const hero = draftState.bans[index];
        if (hero) {
          img.src = hero.ImageURL;
          mainSlot.classList.add('disabled');
        }
        mainSlot.onclick = () => {
          currentSlot = { type, index };
          openModal('Select Hero to Ban');
        };
      } else {
        const hero = draftState.picks[index];
        if (hero) {
          img.src = hero.ImageURL;
        }
        mainSlot.onclick = () => {
          currentSlot = { type, index };
          openModal('Select Hero to Pick');
        };
      }

      slot.appendChild(mainSlot);

      if (type === 'pick') {
        const passiveContainer = document.createElement('div');
        passiveContainer.className = 'passive-slots';
        for (let i = 0; i < 3; i++) {
          const pSlot = document.createElement('div');
          pSlot.className = 'passive-slot';
          const passive = draftState.passives[index][i];
          if (passive) {
            pSlot.style.backgroundImage = `url(${passive.ImageURL})`;
            pSlot.style.backgroundSize = 'cover';
          }
          pSlot.onclick = () => {
            currentSlot = { type: 'passive', pickIndex: index, passiveIndex: i };
            openModal('Select Passive Skill');
          };
          passiveContainer.appendChild(pSlot);
        }
        slot.appendChild(passiveContainer);
      }

      return slot;
    }

    function openModal(title) {
      modalTitle.textContent = title;
      heroGrid.innerHTML = '';
      const usedHeroes = new Set();
      draftState.bans.forEach(h => h && usedHeroes.add(h.Hero));
      draftState.picks.forEach(h => h && usedHeroes.add(h.Hero));

      characterData.forEach(hero => {
        const container = document.createElement('div');
        container.className = 'hero-grid-item';
        const img = document.createElement('img');
        img.src = hero.ImageURL;
        img.alt = hero.Hero;
        img.title = hero.Hero;

        const isUsed = usedHeroes.has(hero.Hero);
        if (currentSlot.type === 'ban' && isUsed) {
          img.classList.add('disabled');
          const overlay = document.createElement('div');
          overlay.className = 'banned-overlay';
          overlay.innerText = 'USED';
          container.appendChild(overlay);
        } else if (currentSlot.type === 'pick' && isUsed) {
          img.classList.add('disabled');
          const overlay = document.createElement('div');
          overlay.className = 'banned-overlay';
          overlay.innerText = 'USED';
          container.appendChild(overlay);
        } else {
          img.onclick = () => {
            if (currentSlot.type === 'ban') {
              draftState.bans[currentSlot.index] = hero;
            } else if (currentSlot.type === 'pick') {
              draftState.picks[currentSlot.index] = hero;
            } else if (currentSlot.type === 'passive') {
              draftState.passives[currentSlot.pickIndex][currentSlot.passiveIndex] = hero;
            }
            closeModal();
            renderDraft();
          };
        }

        container.appendChild(img);
        container.appendChild(document.createElement('div 

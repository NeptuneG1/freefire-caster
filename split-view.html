<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Split View — Characters & Weapons</title>

  <style>
    :root{
      --bg:#0e0e0e;
      --panel:#1b1b1b;
      --ink:#f5f5f5;
      --muted:#b9b9b9;
      --brand:#ffbd59;
      --line:#333;

      --header-h:64px;
      --divider-w:6px;
      --min-pane:240px;
    }

    *{box-sizing:border-box}
    html,body{height:100%;margin:0;background:var(--bg);color:var(--ink);font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Ubuntu,Arial,sans-serif}

    /* Minimal top bar */
    header{
      height:var(--header-h);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      padding:12px 14px;
      background:#1f1f1f;
      border-bottom:3px solid var(--brand);
      position:sticky; top:0; z-index:10;
    }
    .title{
      font-weight:900;
      letter-spacing:.3px;
      color:var(--brand);
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    .actions{display:flex; gap:10px; align-items:center; flex:0 0 auto}

    .btn{
      appearance:none;
      border:1px solid #2f2f2f;
      border-radius:10px;
      background:#232323;
      color:#eee;
      padding:10px 14px;
      cursor:pointer;
      font-weight:800;
      text-decoration:none;
      display:inline-flex;
      align-items:center;
      gap:8px;
      height:42px;
    }
    .btn:hover{filter:brightness(1.05)}
    .btn:active{transform:translateY(1px)}
    .btn.brand{
      background:var(--brand);
      color:#141414;
      border-color:#000;
    }

    /* Split workspace */
    .workspace{
      height:calc(100vh - var(--header-h));
      display:flex;
      overflow:hidden;
      background:var(--panel);
    }

    iframe{
      height:100%;
      border:0;
      background:#0f0f0f;
      width:100%;
    }
    .left{flex:0 0 40%}   /* default 2/5 */
    .right{flex:0 0 60%}  /* default 3/5 */

    .divider{
      width:var(--divider-w);
      background:var(--brand);
      cursor:col-resize;
      box-shadow:0 0 0 1px #000 inset;
      position:relative;
      touch-action:none;
    }
    .divider::after{
      content:"";
      position:absolute;
      left:50%; top:50%;
      width:18px; height:44px;
      transform:translate(-50%,-50%);
      border-radius:999px;
      background:rgba(0,0,0,.25);
      border:1px solid rgba(255,255,255,.12);
      opacity:.9;
    }
    .divider.dragging{filter:brightness(1.15)}
  </style>
</head>
<body>

  <header>
    <div class="title">Split View — Characters & Weapons</div>
    <div class="actions">
      <a class="btn" href="dashboard.html">← Back to Dashboard</a>
      <button class="btn brand" id="resetSplitBtn" type="button">Reset Split (2/5 · 3/5)</button>
    </div>
  </header>

  <div class="workspace" id="workspace">
    <!-- Change these if your real filenames are different -->
    <iframe class="left"  id="paneLeft"  src="character.html" title="Characters"></iframe>
    <div class="divider"  id="divider"   title="Drag to resize (double-click to reset)"></div>
    <iframe class="right" id="paneRight" src="weapon.html"    title="Weapons"></iframe>
  </div>

  <script>
    (function(){
      const divider = document.getElementById('divider');
      const work    = document.getElementById('workspace');
      const left    = document.getElementById('paneLeft');
      const right   = document.getElementById('paneRight');
      const reset   = document.getElementById('resetSplitBtn');

      const DIV_W = parseInt(getComputedStyle(divider).width, 10) || 6;
      const MIN   = parseInt(getComputedStyle(document.documentElement).getPropertyValue('--min-pane'), 10) || 240;

      const storeKey = 'ff_split_ratio_v1';
      let isDragging = false;
      let leftRatio  = parseFloat(localStorage.getItem(storeKey) || '0.40'); // default 2/5

      function applyWidthsByRatio(ratio){
        const rect = work.getBoundingClientRect();
        const total = rect.width;

        const leftW  = Math.max(MIN, Math.min(total - DIV_W - MIN, Math.round(total * ratio)));
        const rightW = total - DIV_W - leftW;

        left.style.flex  = `0 0 ${leftW}px`;
        right.style.flex = `0 0 ${rightW}px`;
      }

      function clampX(x, rect){
        return Math.max(MIN, Math.min(x, rect.width - DIV_W - MIN));
      }

      function startDrag(e){
        isDragging = true;
        divider.classList.add('dragging');
        divider.setPointerCapture?.(e.pointerId);
      }

      function onDrag(e){
        if(!isDragging) return;
        const rect = work.getBoundingClientRect();
        let x = e.clientX - rect.left;
        x = clampX(x, rect);
        leftRatio = x / rect.width;
        applyWidthsByRatio(leftRatio);
      }

      function stopDrag(){
        if(!isDragging) return;
        isDragging = false;
        divider.classList.remove('dragging');
        localStorage.setItem(storeKey, String(leftRatio));
      }

      function resetSplit(){
        leftRatio = 0.40; // 2/5
        applyWidthsByRatio(leftRatio);
        localStorage.setItem(storeKey, String(leftRatio));
      }

      function handleResize(){ applyWidthsByRatio(leftRatio); }

      divider.addEventListener('pointerdown', startDrag);
      window.addEventListener('pointermove', onDrag);
      window.addEventListener('pointerup', stopDrag);
      window.addEventListener('pointercancel', stopDrag);

      reset.addEventListener('click', resetSplit);
      divider.addEventListener('dblclick', resetSplit);
      window.addEventListener('resize', handleResize);

      // initial
      applyWidthsByRatio(leftRatio);
    })();
  </script>

</body>
</html>

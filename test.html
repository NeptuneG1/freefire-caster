<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Free Fire Dashboard</title>

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600&family=Roboto:wght@400;500;700&display=swap" rel="stylesheet" />

  <!-- Supabase JS v2 (CDN) -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

  <style>
    :root{
      --bg:#07090f;
      --bg2:#0b1020;
      --panel: rgba(20, 26, 38, .72);
      --panel2: rgba(14, 18, 28, .70);
      --card: rgba(255,255,255,.05);
      --card2: rgba(255,255,255,.07);
      --line: rgba(255,255,255,.08);
      --line2: rgba(255,255,255,.12);
      --ink:#f4f6ff;
      --muted:#aab1c5;

      --brand:#ffbd59;
      --brand2:#ff7733;
      --accent:#4dd3ff;

      --radius:16px;
      --radius-lg:22px;
      --shadow: 0 22px 70px rgba(0,0,0,.55);

      --sb-w: 260px;
      --right-w: 350px;
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: Roboto, system-ui, -apple-system, Segoe UI, Arial;
      color:var(--ink);
      background:
        radial-gradient(900px 500px at 18% 12%, rgba(77,211,255,.15), transparent 60%),
        radial-gradient(700px 420px at 85% 18%, rgba(255,189,89,.12), transparent 60%),
        radial-gradient(900px 620px at 50% 110%, rgba(255,119,51,.10), transparent 60%),
        linear-gradient(180deg, var(--bg), var(--bg2));
      overflow-x:hidden;
    }

    /* subtle “arc” accents like the reference UI */
    body::before, body::after{
      content:"";
      position:fixed;
      inset:auto auto 0 0;
      width:520px; height:520px;
      border-radius:50%;
      border:10px solid rgba(77,211,255,.14);
      transform: translate(-45%, -35%);
      filter: blur(.2px);
      pointer-events:none;
    }
    body::after{
      inset: -120px 0 auto auto;
      width:420px; height:420px;
      border:10px solid rgba(77,211,255,.10);
      transform: translate(38%, 0%);
    }

    a{color:inherit}

    /* App Layout */
    .app{
      height:100%;
      display:flex;
      gap:18px;
      padding:18px;
      max-width: 1440px;
      margin: 0 auto;
    }

    /* Sidebar */
    .sidebar{
      width: var(--sb-w);
      background: var(--panel2);
      border: 1px solid var(--line);
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow);
      backdrop-filter: blur(14px);
      -webkit-backdrop-filter: blur(14px);
      overflow:hidden;
      display:flex;
      flex-direction:column;
      position:relative;
    }

    .brand{
      display:flex;
      align-items:center;
      gap:10px;
      padding:16px 16px 10px 16px;
      border-bottom: 1px solid var(--line);
    }
    .logo{
      width:36px;height:36px;border-radius:12px;
      background: linear-gradient(135deg, rgba(255,189,89,.25), rgba(77,211,255,.18));
      border:1px solid rgba(255,255,255,.10);
      display:grid;place-items:center;
      font-family: Orbitron, sans-serif;
      letter-spacing:.5px;
      color:var(--brand);
      box-shadow: 0 10px 30px rgba(0,0,0,.35);
    }
    .brand h1{
      margin:0;
      font-family: Orbitron, sans-serif;
      font-size: 1.05rem;
      letter-spacing:.6px;
    }
    .brand small{
      display:block;
      color: var(--muted);
      font-size:.78rem;
      margin-top:2px;
    }

    .nav{
      padding: 12px;
      display:flex;
      flex-direction:column;
      gap:8px;
      overflow:auto;
    }
    .nav::-webkit-scrollbar{width:10px}
    .nav::-webkit-scrollbar-thumb{background: rgba(255,255,255,.08); border-radius:10px}
    .nav::-webkit-scrollbar-track{background: transparent}

    .nav-item{
      display:flex;
      align-items:center;
      gap:10px;
      padding:10px 10px;
      border-radius: 12px;
      border:1px solid transparent;
      color: var(--muted);
      text-decoration:none;
      transition: .2s ease;
      cursor:pointer;
    }
    .nav-item:hover{
      background: rgba(255,255,255,.05);
      border-color: rgba(255,255,255,.08);
      color: var(--ink);
    }
    .nav-item.active{
      background: linear-gradient(135deg, rgba(255,189,89,.14), rgba(77,211,255,.09));
      border-color: rgba(255,189,89,.22);
      color: var(--ink);
    }
    .nav-ico{
      width:26px;height:26px;border-radius:10px;
      background: rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.08);
      display:grid;place-items:center;
      flex: 0 0 auto;
    }
    .nav-ico svg{width:14px;height:14px;opacity:.9}

    .sidebar-foot{
      margin-top:auto;
      padding:12px 14px 14px 14px;
      border-top:1px solid var(--line);
      color: var(--muted);
      font-size:.82rem;
    }
    .pill{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:8px 10px;
      border-radius: 999px;
      background: rgba(255,255,255,.05);
      border:1px solid rgba(255,255,255,.09);
    }
    .dot{
      width:8px;height:8px;border-radius:999px;background: var(--brand);
      box-shadow: 0 0 18px rgba(255,189,89,.35);
    }

    /* Main */
    .main{
      flex:1;
      display:flex;
      flex-direction:column;
      min-width: 0;
      gap: 14px;
    }

    /* Topbar */
    .topbar{
      background: var(--panel);
      border: 1px solid var(--line);
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow);
      backdrop-filter: blur(14px);
      -webkit-backdrop-filter: blur(14px);
      padding: 12px 14px;
      display:flex;
      align-items:center;
      gap:12px;
    }

    .burger{
      display:none;
      width:42px;height:42px;border-radius:14px;
      background: rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.10);
      color:var(--ink);
      cursor:pointer;
    }

    .search{
      flex:1;
      display:flex;
      align-items:center;
      gap:10px;
      padding: 10px 12px;
      background: rgba(0,0,0,.22);
      border:1px solid rgba(255,255,255,.10);
      border-radius: 14px;
      min-width: 0;
    }
    .search input{
      width:100%;
      background: transparent;
      border:0;
      outline:none;
      color: var(--ink);
      font-size: .95rem;
    }
    .search input::placeholder{color: rgba(170,177,197,.75)}

    .top-actions{
      display:flex;
      align-items:center;
      gap:10px;
      flex:0 0 auto;
    }

    .icon-btn{
      width:42px;height:42px;border-radius:14px;
      background: rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.10);
      display:grid;place-items:center;
      cursor:pointer;
      transition:.2s ease;
    }
    .icon-btn:hover{transform: translateY(-1px); background: rgba(255,255,255,.08)}
    .icon-btn svg{width:18px;height:18px;opacity:.92}

    .userchip{
      display:flex;
      align-items:center;
      gap:10px;
      padding: 8px 10px;
      border-radius: 999px;
      background: rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.10);
      max-width: 240px;
    }
    .avatar{
      width:28px;height:28px;border-radius:10px;
      background: linear-gradient(135deg, rgba(255,189,89,.30), rgba(77,211,255,.18));
      border:1px solid rgba(255,255,255,.10);
    }
    .usertext{min-width:0}
    .usertext b{
      display:block;
      font-size:.92rem;
      font-family: Orbitron, sans-serif;
      color: var(--brand);
      white-space: nowrap;
      overflow:hidden;
      text-overflow: ellipsis;
      max-width: 170px;
    }
    .usertext span{display:block; font-size:.78rem; color: var(--muted)}

    .logout{
      color: rgba(255,255,255,.70);
      text-decoration:none;
      font-size:.85rem;
      padding: 8px 10px;
      border-radius: 10px;
      border:1px solid rgba(255,255,255,.08);
      background: rgba(255,255,255,.04);
      transition:.2s ease;
      cursor:pointer;
      white-space:nowrap;
    }
    .logout:hover{
      border-color: rgba(255,77,77,.35);
      color: #ff8d8d;
      box-shadow: 0 0 0 3px rgba(255,77,77,.10);
    }

    /* Content Grid (Center + Right) */
    .content{
      display:grid;
      grid-template-columns: 1fr var(--right-w);
      gap: 14px;
      min-height: 0;
      flex:1;
    }
    .center{
      min-width:0;
      display:flex;
      flex-direction:column;
      gap: 14px;
    }
    .right{
      min-width:0;
      display:flex;
      flex-direction:column;
      gap: 14px;
    }

    /* Cards */
    .card{
      background: var(--panel);
      border: 1px solid var(--line);
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow);
      backdrop-filter: blur(14px);
      -webkit-backdrop-filter: blur(14px);
      overflow:hidden;
    }
    .card-inner{padding:14px}
    .card h2, .card h3, .card h4{margin:0}
    .muted{color: var(--muted)}
    .title{
      font-family: Orbitron, sans-serif;
      letter-spacing: .6px;
    }

    /* Hero */
    .hero{
      position:relative;
      height: 160px;
      border-bottom: 1px solid var(--line);
      background:
        linear-gradient(90deg, rgba(0,0,0,.55), rgba(0,0,0,.10)),
        url('https://i.imgur.com/qXFpizS.jpg') center/cover no-repeat;
    }
    .hero::after{
      content:"";
      position:absolute; inset:0;
      background: radial-gradient(420px 220px at 55% 45%, rgba(255,189,89,.16), transparent 60%);
      pointer-events:none;
    }
    .hero-content{
      position:absolute;
      left:16px; right:16px; bottom:14px;
      display:flex;
      align-items:flex-end;
      justify-content: space-between;
      gap: 12px;
    }
    .hero-title{
      display:flex;
      flex-direction:column;
      gap:6px;
      min-width:0;
    }
    .hero-title h2{
      font-family: Orbitron, sans-serif;
      font-size: 1.55rem;
      color: var(--brand);
      text-shadow: 0 0 18px rgba(255,189,89,.20);
      margin:0;
      white-space:nowrap;
      overflow:hidden;
      text-overflow: ellipsis;
    }
    .chips{
      display:flex; flex-wrap:wrap;
      gap:8px;
    }
    .chip{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding: 7px 10px;
      border-radius: 999px;
      background: rgba(0,0,0,.28);
      border: 1px solid rgba(255,255,255,.12);
      color: rgba(244,246,255,.88);
      font-size: .82rem;
      white-space:nowrap;
    }
    .chip .mini-dot{
      width:8px;height:8px;border-radius:999px;
      background: var(--accent);
      box-shadow: 0 0 16px rgba(77,211,255,.25);
    }

    .hero-actions{
      display:flex;
      gap:10px;
      align-items:center;
      flex:0 0 auto;
    }
    .cta{
      display:inline-flex;
      align-items:center;
      gap:10px;
      padding: 10px 12px;
      border-radius: 14px;
      border: 1px solid rgba(255,189,89,.25);
      background: linear-gradient(135deg, rgba(255,189,89,.18), rgba(255,119,51,.10));
      cursor:pointer;
      transition:.2s ease;
      text-decoration:none;
      font-weight:700;
      color: var(--ink);
      font-size: .92rem;
    }
    .cta:hover{transform: translateY(-1px); box-shadow: 0 0 0 3px rgba(255,189,89,.10)}
    .cta svg{width:16px;height:16px}

    /* Stat Tiles Row */
    .tiles{
      display:grid;
      grid-template-columns: repeat(4, minmax(0, 1fr));
      gap: 12px;
    }
    .tile{
      padding: 12px;
      border-radius: var(--radius);
      background: rgba(255,255,255,.05);
      border:1px solid rgba(255,255,255,.09);
      cursor:pointer;
      transition:.2s ease;
      min-width:0;
    }
    .tile:hover{transform: translateY(-1px); background: rgba(255,255,255,.07)}
    .tile .k{
      color: var(--muted);
      font-size:.82rem;
      margin-bottom:8px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
    }
    .tile .v{
      font-family: Orbitron, sans-serif;
      font-size: 1.25rem;
      letter-spacing:.6px;
      color: var(--brand);
      white-space:nowrap;
      overflow:hidden;
      text-overflow: ellipsis;
    }
    .badge{
      font-size:.75rem;
      padding: 4px 8px;
      border-radius: 999px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.18);
      color: rgba(244,246,255,.80);
      white-space:nowrap;
    }

    /* Chart */
    .chart-wrap{padding:14px}
    .row-head{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      margin-bottom:12px;
      flex-wrap:wrap;
    }
    .row-head h3{
      font-family: Orbitron, sans-serif;
      font-size: 1.05rem;
      letter-spacing:.6px;
    }
    .mini-select{
      display:flex; align-items:center; gap:8px;
      color: var(--muted);
      font-size:.85rem;
    }
    .mini-select select{
      background: rgba(0,0,0,.22);
      border:1px solid rgba(255,255,255,.12);
      border-radius: 12px;
      color: var(--ink);
      padding: 8px 10px;
      outline:none;
    }

    /* SVG chart styling */
    .svg-chart{
      width:100%;
      height: 120px;
      display:block;
      border-radius: 16px;
      background: rgba(0,0,0,.18);
      border: 1px solid rgba(255,255,255,.08);
    }
    .chart-note{
      margin-top:10px;
      color: var(--muted);
      font-size:.82rem;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      flex-wrap:wrap;
    }

    /* Table */
    table{
      width:100%;
      border-collapse: collapse;
      font-size:.9rem;
    }
    thead th{
      text-align:left;
      font-size:.78rem;
      color: var(--muted);
      font-weight:700;
      padding: 10px 12px;
      border-bottom: 1px solid var(--line);
    }
    tbody td{
      padding: 10px 12px;
      border-bottom: 1px solid rgba(255,255,255,.06);
      color: rgba(244,246,255,.90);
    }
    tbody tr:hover{background: rgba(255,255,255,.04)}
    .pos{color: #71d083}
    .neg{color: #ff6b6b}

    /* Right column cards */
    .kpi-title{
      padding: 14px 14px 0 14px;
    }
    .kpi-title h3{
      font-family: Orbitron, sans-serif;
      letter-spacing:.6px;
      font-size: 1.1rem;
      margin:0;
    }
    .kpis{
      display:grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap:10px;
      padding: 12px 14px 14px 14px;
    }
    .kpi{
      border-radius: 16px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.18);
      padding: 12px;
      min-width:0;
    }
    .kpi b{
      display:block;
      font-family: Orbitron, sans-serif;
      color: var(--brand);
      font-size: 1.05rem;
      letter-spacing:.6px;
      margin-bottom:6px;
    }
    .kpi span{
      color: var(--muted);
      font-size:.78rem;
    }

    .feed{
      padding: 12px 14px 14px 14px;
      display:flex;
      flex-direction:column;
      gap:10px;
    }
    .msg{
      display:flex;
      gap:10px;
      padding: 10px;
      border-radius: 16px;
      background: rgba(255,255,255,.05);
      border: 1px solid rgba(255,255,255,.09);
      align-items:flex-start;
    }
    .msg .pic{
      width:34px;height:34px;border-radius: 14px;
      background: rgba(255,255,255,.08);
      border:1px solid rgba(255,255,255,.10);
      flex:0 0 auto;
    }
    .msg .t{
      min-width:0;
    }
    .msg .t b{
      display:block;
      font-size:.92rem;
      margin-bottom:4px;
      white-space:nowrap;
      overflow:hidden;
      text-overflow: ellipsis;
    }
    .msg .t p{
      margin:0;
      color: var(--muted);
      font-size:.82rem;
      line-height:1.25rem;
    }

    /* Quick View (right) */
    .qv{
      padding: 12px 14px 14px 14px;
      display:flex;
      flex-direction:column;
      gap:10px;
    }
    .qv .box{
      padding: 10px;
      border-radius: 16px;
      background: rgba(255,255,255,.05);
      border: 1px solid rgba(255,255,255,.09);
    }
    .qv label{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      color: var(--muted);
      font-size:.8rem;
      font-weight:700;
      margin-bottom:8px;
      letter-spacing:.2px;
    }
    .qv select{
      width:100%;
      padding: 10px;
      border-radius: 12px;
      background: rgba(0,0,0,.22);
      color: var(--ink);
      border: 1px solid rgba(255,255,255,.12);
      outline:none;
    }

    .preview{
      margin-top:10px;
      border-radius: 16px;
      background: rgba(0,0,0,.18);
      border: 1px solid rgba(255,255,255,.08);
      overflow:hidden;
    }
    .preview img{
      width:100%;
      height: 140px;
      object-fit: cover;
      display:block;
      background: rgba(255,255,255,.04);
    }
    .preview .info{
      padding: 10px;
    }
    .preview .info b{
      display:block;
      font-size: .95rem;
      margin-bottom:6px;
      white-space:nowrap;
      overflow:hidden;
      text-overflow: ellipsis;
    }
    .preview .info p{
      margin:0;
      color: var(--muted);
      font-size:.82rem;
      line-height:1.25rem;
      max-height: 2.5rem;
      overflow:hidden;
    }

    /* Mobile / Responsive */
    @media (max-width: 1180px){
      :root{ --right-w: 320px; }
      .tiles{grid-template-columns: repeat(2, minmax(0, 1fr));}
    }
    @media (max-width: 980px){
      .content{grid-template-columns: 1fr;}
      .right{order: 2}
      .center{order: 1}
      :root{ --sb-w: 260px; }
      .burger{display:grid; place-items:center}
      .sidebar{
        position: fixed;
        top: 18px; bottom: 18px; left: 18px;
        transform: translateX(-110%);
        transition: .22s ease;
        z-index: 30;
      }
      .sidebar.open{transform: translateX(0)}
      .backdrop{
        position: fixed;
        inset: 0;
        background: rgba(0,0,0,.55);
        backdrop-filter: blur(2px);
        -webkit-backdrop-filter: blur(2px);
        opacity:0;
        pointer-events:none;
        transition:.22s ease;
        z-index: 25;
      }
      .backdrop.show{
        opacity:1;
        pointer-events:auto;
      }
      .app{padding: 14px;}
    }
  </style>
</head>

<body>
  <div class="backdrop" id="backdrop"></div>

  <div class="app">
    <!-- SIDEBAR -->
    <aside class="sidebar" id="sidebar">
      <div class="brand">
        <div class="logo">FF</div>
        <div>
          <h1>Free Fire</h1>
          <small class="muted">Caster Dashboard</small>
        </div>
      </div>

      <nav class="nav" id="nav">
        <a class="nav-item active" href="dashboard.html" data-page="dashboard.html">
          <span class="nav-ico">
            <svg viewBox="0 0 24 24" fill="none"><path d="M4 13h7V4H4v9Zm9 7h7V4h-7v16ZM4 20h7v-5H4v5Z" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
          </span>
          Dashboard
        </a>

        <a class="nav-item" href="char.html" data-page="char.html">
          <span class="nav-ico"><svg viewBox="0 0 24 24" fill="none"><path d="M12 12a4 4 0 1 0-4-4 4 4 0 0 0 4 4Zm0 2c-4 0-7 2-7 4v2h14v-2c0-2-3-4-7-4Z" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg></span>
          Character Skills
        </a>

        <a class="nav-item" href="pet.html" data-page="pet.html">
          <span class="nav-ico"><svg viewBox="0 0 24 24" fill="none"><path d="M7 14c-1.7 0-3-1.3-3-3S5.3 8 7 8s3 1.3 3 3-1.3 3-3 3Zm10 0c-1.7 0-3-1.3-3-3s1.3-3 3-3 3 1.3 3 3-1.3 3-3 3ZM7 20c-2.8 0-5-1.8-5-4v-1h6v1c0 1.1.9 2 2 2h4c1.1 0 2-.9 2-2v-1h6v1c0 2.2-2.2 4-5 4H7Z" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg></span>
          Pets
        </a>

        <a class="nav-item" href="weapon.html" data-page="weapon.html">
          <span class="nav-ico"><svg viewBox="0 0 24 24" fill="none"><path d="M3 21l6-6m0 0 2 2 8-8-2-2-8 8Zm0 0-2-2 4-4 2 2-4 4Z" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg></span>
          Weapons
        </a>

        <a class="nav-item" href="map.html" data-page="map.html">
          <span class="nav-ico"><svg viewBox="0 0 24 24" fill="none"><path d="M10 6 4 8v14l6-2 4 2 6-2V6l-6 2-4-2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg></span>
          Map
        </a>

        <a class="nav-item" href="split-view.html" data-page="split-view.html">
          <span class="nav-ico"><svg viewBox="0 0 24 24" fill="none"><path d="M4 5h16M4 12h16M4 19h16" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg></span>
          Split View
        </a>

        <a class="nav-item" href="clash-draft.html" data-page="clash-draft.html">
          <span class="nav-ico"><svg viewBox="0 0 24 24" fill="none"><path d="M4 7h16M4 12h10M4 17h16" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg></span>
          Clash Squad Draft
        </a>

        <a class="nav-item" href="clash-data.html" data-page="clash-data.html">
          <span class="nav-ico"><svg viewBox="0 0 24 24" fill="none"><path d="M4 19V5m0 14h16M8 17v-6m4 6V7m4 10v-4" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg></span>
          Clash Squad Data
        </a>

        <a class="nav-item" href="clash-compare.html" data-page="clash-compare.html">
          <span class="nav-ico"><svg viewBox="0 0 24 24" fill="none"><path d="M10 3v18M14 3v18M4 7h6M14 17h6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg></span>
          Clash Squad Comparison
        </a>

        <a class="nav-item" href="clash-report.html" data-page="clash-report.html">
          <span class="nav-ico"><svg viewBox="0 0 24 24" fill="none"><path d="M6 3h12v18H6zM9 7h6M9 11h6M9 15h6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg></span>
          Clash Squad Team Report
        </a>

        <a class="nav-item" href="clash-store.html" data-page="clash-store.html">
          <span class="nav-ico"><svg viewBox="0 0 24 24" fill="none"><path d="M4 7h16l-1 14H5L4 7Zm3 0 1-3h8l1 3" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg></span>
          Clash Squad Store
        </a>

        <a class="nav-item" href="br_team2.html" data-page="br_team2.html">
          <span class="nav-ico"><svg viewBox="0 0 24 24" fill="none"><path d="M6 20V10m6 10V4m6 16v-7" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg></span>
          BR Data
        </a>

        <a class="nav-item" href="ff-update.html" data-page="ff-update.html">
          <span class="nav-ico"><svg viewBox="0 0 24 24" fill="none"><path d="M12 2v6m0 14v-6M4.9 4.9l4.2 4.2m10.8 10.8-4.2-4.2M2 12h6m14 0h-6M4.9 19.1l4.2-4.2m10.8-10.8-4.2 4.2" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg></span>
          Free Fire Update
        </a>
      </nav>

      <div class="sidebar-foot">
        <span class="pill"><span class="dot"></span> Neptune UI • V2</span>
      </div>
    </aside>

    <!-- MAIN -->
    <main class="main">
      <header class="topbar">
        <button class="burger icon-btn" id="burger" aria-label="Open menu">
          <svg viewBox="0 0 24 24" fill="none"><path d="M4 7h16M4 12h16M4 17h16" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
        </button>

        <div class="search">
          <svg viewBox="0 0 24 24" fill="none" style="width:18px;height:18px;opacity:.85">
            <path d="M21 21l-4.3-4.3m1.3-5.2a7 7 0 1 1-14 0 7 7 0 0 1 14 0Z" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
          <input id="searchInput" placeholder="Search pages, tools, data..." />
        </div>

        <div class="top-actions">
          <div class="icon-btn" title="Pinned">
            <svg viewBox="0 0 24 24" fill="none"><path d="M15 4 9 10v7l3-3h5l1-1-3-3V4Z" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
          </div>

          <div class="icon-btn" title="Notifications">
            <svg viewBox="0 0 24 24" fill="none"><path d="M18 8a6 6 0 1 0-12 0c0 7-3 7-3 7h18s-3 0-3-7Z" stroke="currentColor" stroke-width="2" stroke-linecap="round"/><path d="M10 19a2 2 0 0 0 4 0" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
          </div>

          <div class="userchip">
            <div class="avatar"></div>
            <div class="usertext">
              <b id="gamertag">PlayerOne</b>
              <span id="userEmail" class="muted">loading…</span>
            </div>
          </div>

          <a class="logout" href="#" id="logoutBtn">Logout</a>
        </div>
      </header>

      <section class="content">
        <!-- CENTER -->
        <div class="center">
          <div class="card">
            <div class="hero">
              <div class="hero-content">
                <div class="hero-title">
                  <h2>Free Fire Dashboard</h2>
                  <div class="chips">
                    <span class="chip"><span class="mini-dot"></span> Live-ready tools</span>
                    <span class="chip"><span class="mini-dot" style="background:var(--brand)"></span> Brand: #ffbd59</span>
                    <span class="chip"><span class="mini-dot" style="background:var(--brand2)"></span> Neptune Build</span>
                  </div>
                </div>

                <div class="hero-actions">
                  <a class="cta" href="clash-draft.html">
                    <svg viewBox="0 0 24 24" fill="none"><path d="M12 5v14m7-7H5" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
                    Open Draft Tool
                  </a>
                </div>
              </div>
            </div>

            <div class="card-inner">
              <div class="tiles">
                <div class="tile" onclick="location.href='char.html'">
                  <div class="k"><span>Characters</span><span class="badge" id="charMeta">meta</span></div>
                  <div class="v" id="charCount">—</div>
                </div>
                <div class="tile" onclick="location.href='pet.html'">
                  <div class="k"><span>Pets</span><span class="badge">support</span></div>
                  <div class="v" id="petCount">—</div>
                </div>
                <div class="tile" onclick="location.href='weapon.html'">
                  <div class="k"><span>Weapons</span><span class="badge">armory</span></div>
                  <div class="v" id="weaponCount">—</div>
                </div>
                <div class="tile" onclick="location.href='br_team2.html'">
                  <div class="k"><span>BR Data</span><span class="badge">analytics</span></div>
                  <div class="v">Open</div>
                </div>
              </div>
            </div>
          </div>

          <div class="card">
            <div class="chart-wrap">
              <div class="row-head">
                <h3 class="title">Activity Timeline</h3>
                <div class="mini-select">
                  <span class="muted">view</span>
                  <select id="timelineMode">
                    <option value="visits">Recent Visits</option>
                    <option value="random">Demo Pattern</option>
                  </select>
                </div>
              </div>

              <svg class="svg-chart" id="timelineChart" viewBox="0 0 600 120" preserveAspectRatio="none" aria-label="Timeline chart"></svg>

              <div class="chart-note">
                <span>Tip: your latest page opens show up here (stored locally).</span>
                <span class="muted" id="lastVisit">Last visit: —</span>
              </div>
            </div>
          </div>

          <div class="card">
            <div class="card-inner">
              <div class="row-head">
                <h3 class="title">Quick Links</h3>
                <span class="muted">Most-used pages</span>
              </div>

              <table>
                <thead>
                  <tr>
                    <th>Tool</th>
                    <th>Type</th>
                    <th>Status</th>
                    <th style="text-align:right">Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>Clash Squad Draft</td>
                    <td class="muted">Live tool</td>
                    <td><span class="pos">Ready</span></td>
                    <td style="text-align:right"><a class="cta" style="padding:8px 10px; border-radius:12px" href="clash-draft.html">Open</a></td>
                  </tr>
                  <tr>
                    <td>Clash Squad Report</td>
                    <td class="muted">Analytics</td>
                    <td><span class="pos">Ready</span></td>
                    <td style="text-align:right"><a class="cta" style="padding:8px 10px; border-radius:12px" href="clash-report.html">Open</a></td>
                  </tr>
                  <tr>
                    <td>Weapons</td>
                    <td class="muted">Reference</td>
                    <td><span class="pos">Ready</span></td>
                    <td style="text-align:right"><a class="cta" style="padding:8px 10px; border-radius:12px" href="weapon.html">Open</a></td>
                  </tr>
                  <tr>
                    <td>Updates</td>
                    <td class="muted">Patch info</td>
                    <td><span class="muted">—</span></td>
                    <td style="text-align:right"><a class="cta" style="padding:8px 10px; border-radius:12px" href="ff-update.html">Open</a></td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>

        <!-- RIGHT -->
        <aside class="right">
          <div class="card">
            <div class="kpi-title">
              <h3>Total Library</h3>
              <p class="muted" style="margin:8px 0 0 0; font-size:.86rem;">Counts pulled from your JSON endpoints</p>
            </div>
            <div class="kpis">
              <div class="kpi">
                <b id="kpiChars">—</b>
                <span>Characters</span>
              </div>
              <div class="kpi">
                <b id="kpiPets">—</b>
                <span>Pets</span>
              </div>
              <div class="kpi">
                <b id="kpiWeapons">—</b>
                <span>Weapons</span>
              </div>
            </div>
          </div>

          <div class="card">
            <div class="card-inner" style="padding-bottom:0">
              <div class="row-head">
                <h3 class="title">Notes</h3>
                <span class="muted">Dashboard feed</span>
              </div>
            </div>
            <div class="feed">
              <div class="msg">
                <div class="pic"></div>
                <div class="t">
                  <b>Neptune Tip</b>
                  <p>Use the sidebar search to jump fast during broadcast prep.</p>
                </div>
              </div>
              <div class="msg">
                <div class="pic"></div>
                <div class="t">
                  <b>Quick View</b>
                  <p>Preview a character, pet, or weapon without leaving the dashboard.</p>
                </div>
              </div>
              <div class="msg">
                <div class="pic"></div>
                <div class="t">
                  <b>Style System</b>
                  <p>This layout is reusable — we’ll wrap your other pages with the same shell next.</p>
                </div>
              </div>
            </div>
          </div>

          <div class="card">
            <div class="card-inner" style="padding-bottom:0">
              <div class="row-head">
                <h3 class="title">Quick View</h3>
                <span class="muted">Pick & preview</span>
              </div>
            </div>

            <div class="qv">
              <div class="box">
                <label>
                  <span>Character</span>
                  <span class="muted" id="charTag">—</span>
                </label>
                <select id="characterSelect"></select>
                <div class="preview" id="characterPreview"></div>
              </div>

              <div class="box">
                <label>
                  <span>Pet</span>
                  <span class="muted" id="petTag">—</span>
                </label>
                <select id="petSelect"></select>
                <div class="preview" id="petPreview"></div>
              </div>

              <div class="box">
                <label>
                  <span>Weapon</span>
                  <span class="muted" id="weaponTag">—</span>
                </label>
                <select id="weaponSelect"></select>
                <div class="preview" id="weaponPreview"></div>
              </div>

              <div class="muted" style="font-size:.8rem; padding: 0 2px;">
                Free Fire Caster © 2025 — Neptune
              </div>
            </div>
          </div>
        </aside>
      </section>
    </main>
  </div>

  <script>
    /***********************
     * Supabase Auth
     ***********************/
    const client = supabase.createClient(
      'https://gkugecflfddkpitlrmws.supabase.co',
      'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImdrdWdlY2ZsZmRka3BpdGxybXdzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDYwODMwNzQsImV4cCI6MjA2MTY1OTA3NH0.OgQOx9k71DDdK1yOa7VNKGSgoFD9kNGo8j-bR91zGKE'
    );

    async function ensureSession(){
      const { data: { session } } = await client.auth.getSession();
      if (!session) {
        window.location.href = "index.html";
        return null;
      }
      return session;
    }

    async function logout(){
      await client.auth.signOut();
      window.location.href = "index.html";
    }

    /***********************
     * Sidebar + Topbar UX
     ***********************/
    const sidebar = document.getElementById('sidebar');
    const burger = document.getElementById('burger');
    const backdrop = document.getElementById('backdrop');

    function openSidebar(){
      sidebar.classList.add('open');
      backdrop.classList.add('show');
    }
    function closeSidebar(){
      sidebar.classList.remove('open');
      backdrop.classList.remove('show');
    }

    burger?.addEventListener('click', () => {
      if (sidebar.classList.contains('open')) closeSidebar();
      else openSidebar();
    });
    backdrop?.addEventListener('click', closeSidebar);

    // highlight active nav based on filename
    (function setActiveNav(){
      const here = (location.pathname.split('/').pop() || 'dashboard.html').toLowerCase();
      document.querySelectorAll('.nav-item').forEach(a => {
        const page = (a.getAttribute('data-page') || '').toLowerCase();
        a.classList.toggle('active', page === here);
      });
    })();

    // sidebar search filters nav items
    document.getElementById('searchInput')?.addEventListener('input', (e) => {
      const q = (e.target.value || '').toLowerCase().trim();
      document.querySelectorAll('#nav .nav-item').forEach(a => {
        const txt = a.textContent.toLowerCase();
        a.style.display = (!q || txt.includes(q)) ? '' : 'none';
      });
    });

    // track visits locally for the timeline
    function pushVisit(name){
      const key = 'ff_visits_v1';
      const now = Date.now();
      const item = { name, ts: now };
      let arr = [];
      try { arr = JSON.parse(localStorage.getItem(key) || '[]'); } catch(e){}
      arr.unshift(item);
      arr = arr.slice(0, 18);
      localStorage.setItem(key, JSON.stringify(arr));
      localStorage.setItem('ff_last_visit', JSON.stringify(item));
    }

    // record “dashboard” visit
    pushVisit('Dashboard');

    // record clicks
    document.querySelectorAll('.nav-item, .tile, .cta').forEach(el => {
      el.addEventListener('click', () => {
        const label = (el.textContent || '').trim().slice(0, 40) || 'Open';
        pushVisit(label);
      }, {capture:true});
    });

    /***********************
     * Timeline SVG Chart
     ***********************/
    function renderTimeline(mode='visits'){
      const svg = document.getElementById('timelineChart');
      if (!svg) return;

      let points = [];
      if (mode === 'visits'){
        let visits = [];
        try { visits = JSON.parse(localStorage.getItem('ff_visits_v1') || '[]'); } catch(e){}
        // Create a simple series from visit timestamps (recency -> higher)
        const n = Math.max(12, Math.min(18, visits.length || 12));
        const base = Date.now();
        for (let i=0;i<n;i++){
          const v = visits[i];
          const age = v ? Math.min(1, (base - v.ts) / (1000*60*60*24*2)) : (i/n);
          const y = 0.25 + (1-age) * 0.65; // newer -> higher
          points.push(y);
        }
        if (!visits.length){
          // fallback
          points = [0.3,0.35,0.5,0.42,0.6,0.55,0.48,0.62,0.7,0.58,0.66,0.6];
        }
      } else {
        points = [0.28,0.38,0.44,0.36,0.58,0.52,0.40,0.62,0.48,0.70,0.56,0.66,0.50,0.72,0.60,0.68];
      }

      const W = 600, H = 120;
      const padX = 18, padY = 16;
      const innerW = W - padX*2;
      const innerH = H - padY*2;

      const xs = points.map((_,i)=> padX + (innerW * (i/(points.length-1 || 1))));
      const ys = points.map(v => padY + (innerH * (1 - v)));

      // build path
      const d = xs.map((x,i)=> `${i===0?'M':'L'} ${x.toFixed(1)} ${ys[i].toFixed(1)}`).join(' ');

      // area path for glow
      const area = `${d} L ${xs[xs.length-1].toFixed(1)} ${(H-padY).toFixed(1)} L ${xs[0].toFixed(1)} ${(H-padY).toFixed(1)} Z`;

      svg.innerHTML = `
        <defs>
          <linearGradient id="g1" x1="0" y1="0" x2="1" y2="0">
            <stop offset="0%" stop-color="rgba(77,211,255,.9)"/>
            <stop offset="55%" stop-color="rgba(255,189,89,.9)"/>
            <stop offset="100%" stop-color="rgba(255,119,51,.9)"/>
          </linearGradient>
          <filter id="glow">
            <feGaussianBlur stdDeviation="2.4" result="b"/>
            <feMerge>
              <feMergeNode in="b"/>
              <feMergeNode in="SourceGraphic"/>
            </feMerge>
          </filter>
        </defs>

        <path d="${area}" fill="rgba(77,211,255,.08)"></path>
        <path d="${d}" fill="none" stroke="url(#g1)" stroke-width="2.6" filter="url(#glow)" stroke-linecap="round"></path>
        ${xs.map((x,i)=>`
          <circle cx="${x.toFixed(1)}" cy="${ys[i].toFixed(1)}" r="4.2" fill="rgba(0,0,0,.30)" stroke="rgba(255,255,255,.20)" stroke-width="1"></circle>
          <circle cx="${x.toFixed(1)}" cy="${ys[i].toFixed(1)}" r="2.6" fill="rgba(255,189,89,.85)"></circle>
        `).join('')}
      `;
    }

    document.getElementById('timelineMode')?.addEventListener('change', (e) => {
      renderTimeline(e.target.value);
    });

    /***********************
     * Quick View: Data + UI
     ***********************/
    const characterData = [];
    const petData = [];
    const weaponData = [];

    function safeText(v){ return (v ?? '').toString(); }

    function makePreview(item){
      const img = item?.image_url || item?.icon || '';
      const title = safeText(item?.name || '—');
      const desc = safeText(item?.skill || item?.type || '') + (item?.description ? ` — ${safeText(item.description)}` : '');
      return `
        ${img ? `<img src="${img}" alt="${title}" />` : `<img src="https://i.imgur.com/qXFpizS.jpg" alt="preview" />`}
        <div class="info">
          <b title="${title}">${title}</b>
          <p title="${desc}">${desc || 'No description available.'}</p>
        </div>
      `;
    }

    function wireSelect(data, selectId, previewId, tagId){
      const sel = document.getElementById(selectId);
      const prev = document.getElementById(previewId);
      const tag = document.getElementById(tagId);

      if (!sel || !prev) return;

      sel.innerHTML = data.map((it, i) => `<option value="${i}">${safeText(it.name || '—')}</option>`).join('');

      const apply = (idx) => {
        const item = data[idx] || data[0];
        prev.innerHTML = makePreview(item);
        if (tag){
          // show meta/cs_meta if available, otherwise show role/type
          const meta = item?.meta ?? item?.cs_meta ?? item?.role ?? item?.type ?? '—';
          tag.textContent = safeText(meta);
        }
      };

      sel.addEventListener('change', () => apply(sel.value));
      apply(0);
    }

    async function loadJson(url){
      const res = await fetch(url, { cache: 'no-store' });
      if (!res.ok) throw new Error('Fetch failed: ' + url);
      return await res.json();
    }

    /***********************
     * Init
     ***********************/
    window.addEventListener('DOMContentLoaded', async () => {
      // auth
      const session = await ensureSession();
      if (!session) return;

      const email = session.user?.email || '';
      document.getElementById('userEmail').textContent = email || 'signed in';
      const username = email ? email.split('@')[0] : 'PlayerOne';
      document.getElementById('gamertag').textContent = username;

      document.getElementById('logoutBtn')?.addEventListener('click', (e) => {
        e.preventDefault();
        logout();
      });

      // last visit label
      try{
        const lv = JSON.parse(localStorage.getItem('ff_last_visit') || 'null');
        if (lv?.ts){
          const d = new Date(lv.ts);
          document.getElementById('lastVisit').textContent = 'Last visit: ' + d.toLocaleString();
        }
      }catch(e){}

      // chart
      renderTimeline(document.getElementById('timelineMode')?.value || 'visits');

      // data loads
      try{
        const [chars, pets, weapons] = await Promise.all([
          loadJson('https://neptuneg1.github.io/freefire-caster/character.json'),
          loadJson('https://neptuneg1.github.io/freefire-caster/pet.json'),
          loadJson('https://neptuneg1.github.io/freefire-caster/weapon.json')
        ]);

        characterData.push(...(Array.isArray(chars) ? chars : []));
        petData.push(...(Array.isArray(pets) ? pets : []));
        weaponData.push(...(Array.isArray(weapons) ? weapons : []));

        // counts
        const c = characterData.length;
        const p = petData.length;
        const w = weaponData.length;

        document.getElementById('charCount').textContent = c.toLocaleString();
        document.getElementById('petCount').textContent = p.toLocaleString();
        document.getElementById('weaponCount').textContent = w.toLocaleString();

        document.getElementById('kpiChars').textContent = c.toLocaleString();
        document.getElementById('kpiPets').textContent = p.toLocaleString();
        document.getElementById('kpiWeapons').textContent = w.toLocaleString();

        // meta badge if available (just detect field)
        const hasMeta = characterData.some(x => x && (x.meta !== undefined || x.cs_meta !== undefined));
        document.getElementById('charMeta').textContent = hasMeta ? 'meta/cs_meta' : 'library';

        // quick view wiring
        wireSelect(characterData, 'characterSelect', 'characterPreview', 'charTag');
        wireSelect(petData, 'petSelect', 'petPreview', 'petTag');
        wireSelect(weaponData, 'weaponSelect', 'weaponPreview', 'weaponTag');

      }catch(err){
        console.error(err);
        // graceful UI fail
        document.getElementById('charCount').textContent = '—';
        document.getElementById('petCount').textContent = '—';
        document.getElementById('weaponCount').textContent = '—';
      }
    });
  </script>
</body>
</html>
